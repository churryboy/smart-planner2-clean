<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>스마트 캘린더 - AI 일정 관리</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body>
    <!-- App Header -->
    <header class="app-header">
        <div class="header-content">
            <div class="logo">
                <span class="logo-text">🗓️ 스마트 플래너</span>
            </div>
            <div class="header-actions">
                <button class="icon-btn" id="calendarViewBtn" title="캘린더 보기">
                    <i class="fas fa-calendar"></i>
                </button>
                <button class="icon-btn" id="todoListViewBtn" title="할일 목록 보기">
                    <i class="fas fa-list"></i>
                </button>
                <button class="icon-btn" id="settingsBtn" title="설정">
                    <i class="fas fa-cog"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Intro View: First interaction - choose mode via buttons -->
        <div id="introView" class="intro-view" style="display: block;">
            <div class="intro-card">
                <h2 class="intro-title">무엇을 도와드릴까요?</h2>
                <p class="intro-sub">원하는 작업 유형을 선택하세요</p>
                <div class="button-grid" id="startButtons">
                    <!-- Goal-tagged buttons -->
                    <button class="home-btn goal" data-mode="goal" data-id="goal_general">🎯 원하는 대학교 입학하기</button>
                    <button class="home-btn goal" data-mode="goal" data-id="goal_study">📚 수능 점수 상승하기</button>
                    <button class="home-btn goal" data-mode="goal" data-id="goal_habit">🌱 중간/기말 점수 상승하기</button>
                    <!-- Task-tagged buttons -->
                    <button class="home-btn task" data-mode="task" data-id="task_event">수행평가 점수 잘받기</button>
                    <button class="home-btn task" data-mode="task" data-id="task_todo">생기부 관리하기</button>
                    <div class="home-input-wrap">
                        <input id="customGoalInput" class="home-input-btn" type="text" placeholder="원하는 목적을 입력하세요" />
                        <button id="customGoalApply" class="home-btn task" data-mode="goal" disabled>적용</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- Calendar View -->
        <div class="calendar-container" id="calendarView">
            <!-- Month Navigation -->
            <div class="month-nav">
                <button class="nav-arrow" id="prevMonth">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <h2 class="current-month" id="currentMonth">2024년 1월</h2>
                <button class="nav-arrow" id="nextMonth">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>

            <!-- Calendar Grid -->
            <div class="calendar-grid" id="calendarGrid">
                <div class="weekday">일</div>
                <div class="weekday">월</div>
                <div class="weekday">화</div>
                <div class="weekday">수</div>
                <div class="weekday">목</div>
                <div class="weekday">금</div>
                <div class="weekday">토</div>
                <!-- Calendar days will be dynamically generated -->
            </div>
            
            <!-- Calendar Legend -->
            <div class="calendar-legend">
                <div class="legend-item">
                    <span class="legend-dot events"></span>
                    <span>이벤트</span>
                </div>
                <div class="legend-item">
                    <span class="legend-dot todos"></span>
                    <span>할일</span>
                </div>
            </div>
        </div>

        <!-- Event List -->
        <div class="event-list-container">
            <div class="section-header">
                <h3>일정 & 할일</h3>
                <span class="event-count" id="eventCount">0개</span>
            </div>
            <div class="event-list" id="eventList">
                <!-- Events and todos will be dynamically generated -->
            </div>
        </div>
        
        <!-- Todo List View -->
        <div class="todo-list-container" id="todoListView" style="display: none;">
            <div class="todo-list-header">
                <h2>할일 목록</h2>
                <p>날짜순으로 정렬된 모든 할일</p>
            </div>
            <div class="todo-list-content" id="todoListContent">
                <!-- Todo items will be dynamically generated -->
            </div>
        </div>
    </main>



    <!-- AI Input Section -->
    <div class="ai-input-section">
        <div class="ai-input-container">
            <div class="ai-input-wrapper">
                <button class="camera-btn" id="cameraBtn" title="사진으로 일정 추가">
                    <i class="fas fa-camera"></i>
                </button>
                <textarea 
                    class="ai-input" 
                    id="aiInput" 
                    placeholder="원하는 일정을 적어보세요"
                    rows="1"
                ></textarea>
                <button class="ai-send-btn" id="aiSendBtn">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
            
            <!-- Hidden file input for camera with mobile optimization -->
            <input type="file" id="cameraInput" accept="image/jpeg,image/png,image/heic,image/webp" capture="environment" style="display: none;">
            <div class="ai-hint">
                <i class="fas fa-info-circle"></i>
                <span>AI가 일정을 자동으로 파악하여 캘린더에 추가합니다</span>
            </div>
        </div>
    </div>

    <!-- Event Detail Modal -->
    <div class="modal" id="eventModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>일정 상세</h3>
                <button class="modal-close" id="modalClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body" id="modalBody">
                <!-- Event details will be dynamically generated -->
            </div>
        </div>
    </div>

    <!-- Todo Recommendations Modal -->
    <div class="modal" id="todoModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>할일 추천</h3>
                <button class="modal-close" id="todoModalClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="todo-recommendations" id="todoRecommendations">
                    <!-- Todo recommendations will be dynamically generated -->
                </div>
            </div>
        </div>
    </div>

    <!-- Image Crop Modal -->
    <div class="modal" id="imageCropModal">
        <div class="modal-content crop-modal">
            <div class="modal-header">
                <h3>이미지 자르기</h3>
                <button class="modal-close" id="cropModalClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="crop-container">
                    <div class="crop-canvas-container">
                        <canvas id="cropCanvas"></canvas>
                        <div class="crop-overlay" id="cropOverlay">
                            <div class="crop-box" id="cropBox">
                                <div class="crop-handle top-left"></div>
                                <div class="crop-handle top-right"></div>
                                <div class="crop-handle bottom-left"></div>
                                <div class="crop-handle bottom-right"></div>
                            </div>
                        </div>
                    </div>
                    <div class="crop-controls">
                        <div class="crop-info">
                            <span id="cropDimensions">선택 영역: 0 x 0</span>
                        </div>
                        <div class="crop-buttons">
                            <button class="crop-btn reset" id="resetCrop">
                                <i class="fas fa-undo"></i>
                                초기화
                            </button>
                            <button class="crop-btn cancel" id="cancelCrop">
                                <i class="fas fa-times"></i>
                                취소
                            </button>
                            <button class="crop-btn confirm" id="confirmCrop">
                                <i class="fas fa-check"></i>
                                확인
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Schedule Confirmation Modal -->
    <div class="modal" id="scheduleConfirmModal">
        <div class="modal-content schedule-confirm-modal">
            <div class="modal-header">
                <h3>일정 추가 확인</h3>
                <button class="modal-close" id="scheduleConfirmClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="schedule-confirm-content">
                    <div class="schedule-items" id="scheduleItems">
                        <!-- Schedule items will be dynamically generated -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Goal/Task Chat Container -->
    <div id="bottomSheet" class="bottom-sheet" style="display: none;">
        <div class="bottom-sheet-header">
            <div class="bs-title" id="bsTitle">대화</div>
            <button class="bs-close" id="bsClose"><i class="fas fa-times"></i></button>
        </div>
        <div class="bottom-sheet-body">
            <div id="bsMessages" class="bs-messages"></div>
            <!-- Output preference (Third interaction) -->
            <div id="outputPref" class="output-pref">
                <div class="pref-title">출력 형식 선택</div>
                <div class="pref-options">
                    <label><input type="radio" name="pref" value="calendar"> 캘린더</label>
                    <label><input type="radio" name="pref" value="todo"> 할일</label>
                    <label><input type="radio" name="pref" value="both"> 둘 다</label>
                </div>
                <button id="prefConfirm" class="pref-confirm">확인</button>
            </div>
        </div>
        <div class="bottom-sheet-input">
            <input id="bsInput" type="text" placeholder="메시지를 입력하세요" />
            <button id="bsSend" class="bs-send"><i class="fas fa-paper-plane"></i></button>
        </div>
    </div>

    <!-- Working View (Console style) -->
    <div id="workingView" class="working-view" style="display: none;">
        <div class="working-card">
            <div class="working-header">
                <i class="fas fa-terminal"></i>
                <span>작업 중...</span>
            </div>
            <pre id="workingLog" class="working-log"></pre>
        </div>
    </div>

    <!-- Loading Indicator -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner">
            <i class="fas fa-spinner fa-spin"></i>
            <p id="loadingText">AI가 일정을 분석하고 있습니다...</p>
            <div class="loading-progress" id="loadingProgress">
                <div class="progress-bar" id="progressBar"></div>
            </div>
        </div>
    </div>

    <script src="config.js"></script>
    <script src="script.js?v=20241220-scroll-fix2"></script>
</body>
</html> 